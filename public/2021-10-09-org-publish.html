<!DOCTYPE html>
<html lang="en">
<head>
<!-- 09 10 2021 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>How I Build My Site</title>
<meta name="generator" content="Org mode">
<meta name="author" content="Francisco Cornejo">
<meta charset="utf-8">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="robots" content="index,follow">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Francisco Cornejo-Garcia</title>
    <link href="static/css/normalize.css" rel="stylesheet" type="text/css">
    <link href="static/css/main.css"rel="stylesheet" type="text/css">
</head>
<body>
<div id="preamble" class="status">
<header>
    <div class="with-image">
        <img src="static/img/profile/profile-1024.jpeg">
        <p>Francisco Cornejo-Garcia <span class="tagline">RIT | Computer Science</p>
    </div>
    <nav>
        <a href="index.html">About</a>
        <a href="posts.html">Posts</a>
    </nav>
</header>
</div>
<div id="content">
<header>
<h1 class="title">How I Build My Site</h1>
</header><p>
I use Emacs to build my site from a collection of org files into a series of web pages. The current setup is developed on a Mac with a Doom Emacs distribution.
</p>

<div id="outline-container-org59580a3" class="outline-2">
<h2 id="org59580a3">Intro</h2>
<div class="outline-text-2" id="text-org59580a3">
<p>
This is the commented header section that documents the following file as a configuration file that publishes a series of org files as html webpages.
</p>

<div class="org-src-container">
<pre class="src src-elisp">;;; build-site.el --- Description -*- lexical-binding: t; -*-
;;
;; Copyright (C) 2021 Francisco Cornejo-Garcia
;;
;; Author: Francisco Cornejo-Garcia &lt;https://github.com/franciscornejog&gt;
;; Maintainer: Francisco Cornejo-Garcia &lt;franciscornejog@gmail.com&gt;
;; Created: October 02, 2021
;; Modified: October 02, 2021
;; Version: 0.0.1
;; Keywords: abbrev bib c calendar comm convenience data docs emulations extensions faces files frames games hardware help hypermedia i18n internal languages lisp local maint mail matching mouse multimedia news outlines processes terminals tex tools unix vc wp
;; Homepage: https://github.com/franciscornejogarcia/build-site
;; Package-Requires: ((emacs "24.3"))
;;
;; This file is not part of GNU Emacs.
;;
;;; Commentary:
;;
;;  Description
;;
;;; Code:

;; load publishing system
(require 'ox-publish)
</pre>
</div>
</div>
</div>

<div id="outline-container-org6c9710f" class="outline-2">
<h2 id="org6c9710f">Variables</h2>
<div class="outline-text-2" id="text-org6c9710f">
<div class="org-src-container">
<pre class="src src-elisp">(defvar build-site-html-head
    "&lt;meta charset=\"utf-8\"&gt;
    &lt;meta name=\"HandheldFriendly\" content=\"True\"&gt;
    &lt;meta name=\"MobileOptimized\" content=\"320\"&gt;
    &lt;meta name=\"robots\" content=\"index,follow\"&gt;
    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;
    &lt;title&gt;Francisco Cornejo-Garcia&lt;/title&gt;
    &lt;link href=\"static/css/normalize.css\" rel=\"stylesheet\" type=\"text/css\"&gt;
    &lt;link href=\"static/css/main.css\"rel=\"stylesheet\" type=\"text/css\"&gt;")

(defvar build-site-html-preamble
  "&lt;header&gt;
    &lt;div class=\"with-image\"&gt;
	&lt;img src=\"static/img/profile/profile-1024.jpeg\"&gt;
	&lt;p&gt;Francisco Cornejo-Garcia &lt;span class=\"tagline\"&gt;RIT | Computer Science&lt;/p&gt;
    &lt;/div&gt;
    &lt;nav&gt;
	&lt;a href=\"index.html\"&gt;About&lt;/a&gt;
	&lt;a href=\"posts.html\"&gt;Posts&lt;/a&gt;
    &lt;/nav&gt;
&lt;/header&gt;")

(defvar build-site-html-postamble
"&lt;footer&gt;
    &lt;p&gt;Copyright 2021 Francisco Cornejo-Garcia  All Rights Reserved.&lt;/p&gt;
    &lt;p&gt;Available under &lt;a href=\"https://creativecommons.org/licenses/by-sa/3.0/us/\"&gt;
	Creative Commons Attribution ShareAlike&lt;/a&gt;.
    &lt;/p&gt;
 &lt;/footer&gt;")
</pre>
</div>
</div>
</div>

<div id="outline-container-org56d513a" class="outline-2">
<h2 id="org56d513a">Convert org links to connect to HTML pages</h2>
<div class="outline-text-2" id="text-org56d513a">
<div class="org-src-container">
<pre class="src src-elisp">(defun build-site-org-export-convert-txt-links (backend)
  "Convert all text links to html links in the BACKEND."
  (cond ((string= backend "html")
  (let ((txt-regex "\\[file:\\(.*\\)\.txt\\]"))
    (while (re-search-forward txt-regex nil t)
      (build-site-convert-txt-link (match-string 1)))))))
(defun build-site-convert-txt-link (name)
  "Convert a NAME of a text link into an html link."
  (replace-match (concat "[file:" name ".html]")))
(add-hook 'org-export-before-processing-hook #'build-site-org-export-convert-txt-links)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgedd50f0" class="outline-2">
<h2 id="orgedd50f0">Set default parameters</h2>
<div class="outline-text-2" id="text-orgedd50f0">
<div class="org-src-container">
<pre class="src src-elisp">(setq org-html-validation-link nil            ;; remove validate link
      org-html-head-include-scripts nil       ;; remove default scripts
      org-html-head-include-default-style nil ;; remove default styles
      org-html-head build-site-html-head
      org-html-preamble build-site-html-preamble
      org-html-postamble build-site-html-postamble
      org-html-coding-system 'utf-8-unix
      org-html-metadata-timestamp-format "%d %m %Y"
      org-html-htmlize-output-type 'css
      org-html-doctype "html5"
      org-html-html5-fancy t)
</pre>
</div>
</div>
</div>

<div id="outline-container-org9931009" class="outline-2">
<h2 id="org9931009">Publishing Rules</h2>
<div class="outline-text-2" id="text-org9931009">
<div class="org-src-container">
<pre class="src src-elisp">;; define publishing project
(setq org-publish-project-alist
      (list
       (list "franciscornejog"
	     :base-extension "txt"
	     :base-directory "content"
	     :publishing-directory "public"
	     :publishing-function 'org-html-publish-to-html
	     :htmlized-source t       ;; enable htmlize
	     :with-date t
	     :with-author nil         ;; remove author name
	     :with-toc nil            ;; remove table of contents
	     :section-numbers nil     ;; remove section numbers
	     :time-stamp-file nil)    ;; remove time stamp
       (list "posts"
	     :recursive t
	     :base-directory "content/posts"
	     :base-extension "txt"
	     :publishing-directory "public"
	     :publishing-function 'org-html-publish-to-html
	     :htmlized-source t       ;; enable htmlize
	     :with-date t
	     :with-toc nil            ;; remove table of contents
	     :section-numbers nil     ;; remove section numbers
	     :time-stamp-file t       ;; remove time stamp
	     :auto-sitemap t
	     :sitemap-title "Posts"
	     :sitemap-filename "posts.txt"
	     :sitemap-sort-files 'anti-chronologically
	     :sitemap-style 'list)
       (list "static"
	     :recursive t
	     :base-directory "static"
	     :base-extension "css\\|jpg\\|jpeg"
	     :publishing-directory "public/static"
	     :publishing-function 'org-publish-attachment)))
</pre>
</div>

<p>
After generating all the files, the follow block will publish these files to their directories and send a message once the build is complete.
</p>

<div class="org-src-container">
<pre class="src src-elisp">;; generate site output
(org-publish-all t)
(message "Build complete!")
;;; build-site.el ends here
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<footer>
    <p>Copyright 2021 Francisco Cornejo-Garcia  All Rights Reserved.</p>
    <p>Available under <a href="https://creativecommons.org/licenses/by-sa/3.0/us/">
        Creative Commons Attribution ShareAlike</a>.
    </p>
 </footer>
</div>
</body>
</html>
